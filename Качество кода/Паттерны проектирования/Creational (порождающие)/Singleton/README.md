# Singleton (Одиночка)

Паттерн Singleton - это класс, который имеет только один экземпляр объекта (или объектный литерал) доступный из любой части программы.

![alt text](./_assets/image.png)
<br>

## _Когда нужен?_

Когда в приложении требуется только один экземпляр объекта, доступный из любой части программы.
<br>

## Как создавать Singleton:

1. Объектный литерал (Создать глобальную переменную и обращаться к ней)

```javascript
const instance1 = {
  name: "singleton"
}

const instance2 = {
  name: "singleton"
}

instance1  === instance2 // false
/* т.к. {} === {} --> false
```

2. Определить Singleton внутри обьекта (класса)

Проверяем, существует ли уже экземпляр класса. Если да, то возвращаем ссылку на существующий объект, а не создаем новый.

```javascript
class Counter {
  // Eсли instance-а еще не существует то создает его и начинает на него ссылаться
  constructor() {
    if (typeof Counter.instance === "object") {
      return Counter.instance;
    }
    this.count = 0;
    Counter.instance = this;
    return this;
  }
  getCount() {
    return this.count;
  }
  increaseCount() {
    return this.count++;
  }
}
```

Теперь любой обьект созданный конструктором Counter будет увеличивать один и тот же счетчик:

```javascript
const myCount1 = new Counter();
const myCount2 = new Counter();

myCount1.increaseCount();
myCount1.increaseCount();
myCount2.increaseCount();
myCount2.increaseCount();

console.log(myCount1.getCount()); // 4
console.log(myCount2.getCount()); // 4
```

**_Использование Singleton-класса (2) вместо объектного литерала (1) для:_**

1. **Ленивой инициализации** — объект создаётся только при необходимости, а не заранее.
2. **Наследования и расширения** — можно добавлять функционал через подклассы.
3. **Инкапсуляции данных** — защита приватных данных и методов.
   <br>

## Недостатки:

Этот паттерн использовался так часто что из разряда "паттерны" перешел в "антипаттерны"

1. **Глобальное состояние** Singleton создает глобальное состояние, которое может быть изменено из разных частей программы. Это делает код менее предсказуемым и сложным для отладки.<br>
2. **Усложнение архитектуры** Singleton может приводить к усложнению архитектуры приложения, так как приводит к сильной связанности между компонентами.<br>
3. **Сложность тестирования** Тестирование кода, использующего Singleton, становится сложнее. При тестировании мы не можем легко подменить или замокировать Singleton, так как он всегда возвращает один и тот же экземпляр.<br>
4. **Нарушение принципа единственной ответственности** Singleton может объединять в себе несколько обязанностей, что нарушает принцип единственной ответственности (SRP).

![alt text](./_assets/image2.png)
